#include <Adafruit_GFX.h>
#include <Adafruit_PCD8544.h>

// تعريف الشاشة Nokia 5110
#define PIN_SCLK 6
#define PIN_DIN 7
#define PIN_DC 4
#define PIN_CE 15
#define PIN_RST 8

Adafruit_PCD8544 display = Adafruit_PCD8544(PIN_SCLK, PIN_DIN, PIN_DC, PIN_CE, PIN_RST);

// تعريف أزرار التحكم
#define BTN_UP 15
#define BTN_DOWN 16
#define BTN_SELECT 17

// تعريف عناصر القائمة
const char* menuItems[] = {"NFC", "Sub-GHz", "Infrared", "WiFi", "Bluetooth"};
const int menuSize = sizeof(menuItems) / sizeof(menuItems[0]);

int selectedIndex = 0; // لتتبع العنصر المحدد

void setup() {
    pinMode(BTN_UP, INPUT_PULLUP);
    pinMode(BTN_DOWN, INPUT_PULLUP);
    pinMode(BTN_SELECT, INPUT_PULLUP);

    display.begin();
    display.setContrast(50);
    display.clearDisplay();
    display.display();
    
    drawMenu();
}

void loop() {
    if (digitalRead(BTN_UP) == LOW) {
        selectedIndex = (selectedIndex - 1 + menuSize) % menuSize;
        drawMenu();
        delay(200);
    }

    if (digitalRead(BTN_DOWN) == LOW) {
        selectedIndex = (selectedIndex + 1) % menuSize;
        drawMenu();
        delay(200);
    }

    if (digitalRead(BTN_SELECT) == LOW) {
        handleSelection();
        delay(200);
    }
}

// دالة لرسم القائمة على الشاشة
void drawMenu() {
    display.clearDisplay();
    
    for (int i = 0; i < menuSize; i++) {
        if (i == selectedIndex) {
            display.setTextColor(BLACK, WHITE); // تمييز العنصر المحدد
        } else {
            display.setTextColor(WHITE, BLACK);
        }
        
        display.setCursor(10, i * 10);
        display.print(menuItems[i]);
    }
    
    display.display();
}

// دالة لمعالجة تحديد العنصر
void handleSelection() {
    display.clearDisplay();
    display.setTextColor(BLACK);
    display.setCursor(10, 20);
    display.print("Selected:");
    display.setCursor(10, 30);
    display.print(menuItems[selectedIndex]);
    display.display();
    delay(1000);
    drawMenu();
}
